# Dog Recognition

## Introduction

This is a project based on Convolutional Neural Networks for identification of dog breeds.

The project is divided into two parts.

The training dataset and test dataset used in both parts are the same, where the first part includes the validation dataset and the second part includes the annotation set.

The image datasets are taken from Tsinghua Dogs Dataset, the link is [here](https://cg.cs.tsinghua.edu.cn/ThuDogs/).

The original dataset contains 130 breeds of dogs while only 10 of them are included in this project.

They are Border Collie, French Bulldog, Pomeranian, Samoyed, Shiba Dog, Siberian Husky, Chow, Golden Retriever, Malamute, and Miniature Schnauzer.

So make sure you choose images from these 10 breeds for testing.

![](https://github.com/ACM40960/project-22205799/blob/479e333fcffdbb143c8bd77640894a50f4cde309/images/10_dogs.jpg)

## Part I

### R project based on traditional convolutional neural networks and data augmentation

Convolutional neural networks (CNNs) are a type of artificial neural network that is widely used in image and language Recognition Domain. CNNs are characterized by their weight-sharing network structure, which reduces the complexity of the network and the number of parameters required, making them more efficient and effective for processing high-dimensional input data, such as images.

CNNs consist of multiple layers, including convolutional layers, pooling layers, and fully connected layers. Convolutional layers perform feature extraction by applying filters (also known as kernels) to the input data, detecting patterns and features at different scales and locations. Pooling layers reduce the spatial dimensions of the feature maps generated by the convolutional layers, reducing overfitting and computational load. Finally, fully connected layers perform classification or regression tasks by connecting all neurons in the previous layer to the output layer.

![](https://github.com/ACM40960/project-22205799/blob/c0f1f39f12dab96d2c09abbb4c65d5e265bf1a81/images/CCN31.jpg)

Data augmentation is a technique used to artificially increase the size of the training dataset by applying various transformations to the existing data, such as rotation, translation, scaling, and flipping. Data augmentation helps to improve the generalization performance of the CNNs by introducing variations and reducing overfitting. By augmenting the data during training, CNNs become more robust to different transformations and can better handle unseen patterns and variations in the test data. This technique is particularly useful for tasks such as image classification, where objects can appear in different orientations and scales within the same class. Data augmentation techniques include random cropping, flipping, rotation, scaling, and Gaussian noise addition.

### What you should know before using

1. need an environment to run R scripts, such as Rstudio
2. install packages in the R environment: shiny, keras, tensorflow
3. need Python 3.9 or above, and install tensorflow in Python environment (version 2.13.0 below, not including 2.13.0)
4. change the path of python.exe in CNN_APP.R
```python
library(shiny)
library(base64enc)
library(keras)
library(tensorflow)
reticulate::use_python('C:/ProgramData/Anaconda3/python.exe') # set to your python.exe
```
5. set the directory where CNN_APP.R is located as the working directory of R environment

### How to use

1. Run the CNN_APP.R script, make sure it is in the same directory as the 'data' and 'model' folders before running

2. Proceed as shown below

Note that you can only choose one image at a time, either from 'data/test' folder or from the internet. As mentioned at the beginning, it is best to choose images from these 10 dog breeds for testing.

The biggest red font of breed stands for the most likely breed predicted by the model.

![](https://github.com/ACM40960/project-22205799/blob/c0f1f39f12dab96d2c09abbb4c65d5e265bf1a81/images/dog_recognition.gif)

### A brief description of other useful files

CNN.R: scripts for dataset import and model training, validation, testing

CNN.html: demonstrates the exact process of dataset import and model training, validation and testing.

## Part II (unfinished)

### Python project based on Faster Region convolutional neural networks

Faster R-CNN is an improved version of the Region-based Convolutional Neural Network (R-CNN), which is a popular object detection algorithm. Faster R-CNN addresses some limitations of R-CNN and improves its efficiency and speed.

Faster R-CNN introduces a region proposal network (RPN) that generates region proposals, which are candidate object bounding boxes, for objects in an image. These proposals are then passed through a convolutional neural network (CNN) to extract features. The RPN is built on top of a pre-trained CNN, typically VGG16 or ResNet, and shares its feature maps with the classification and regression branches.

![](https://github.com/ACM40960/project-22205799/blob/c0f1f39f12dab96d2c09abbb4c65d5e265bf1a81/images/faster_r-cnn.png)

Compared to R-CNN, Faster R-CNN has several advantages:

1. Speed: Faster R-CNN is significantly faster than R-CNN because it integrates the region proposal and feature extraction steps. R-CNN involves a separate step to generate region proposals using selective search or other methods, which is computationally expensive. Faster R-CNN generates these proposals in a single step, resulting in faster processing.
2. Efficiency: Faster R-CNN uses a single CNN to perform both feature extraction and classification, which reduces redundant computations. In R-CNN, separate CNNs are used for feature extraction and classification, leading to redundant computations.
3. Shared features: Faster R-CNN shares the same feature maps across different regions of the image, reducing the computational load and allowing for better feature sharing. In R-CNN, each region proposal is passed through a separate CNN, resulting in separate feature representations for each proposal.

Faster R-CNN also includes a ROI-pooling layer that performs spatial pooling on the feature maps corresponding to each region proposal, allowing for further feature extraction and normalization. This helps in obtaining a fixed-size feature representation for each proposal regardless of its size and location in the image.

### Great challenge

The project is built on this [article](https://towardsdatascience.com/understanding-and-implementing-faster-r-cnn-a-step-by-step-guide-11acfff216b0) by optimizing the import of the dataset and the validation and testing of the model performance.

Although Faster RCNN is not as computationally expensive as R-CNN, the computational resources and time required for Faster RCNN model training are still large, which makes model tuning difficult.

If you are interested in this project and have sufficient computational resources, you can improve this project by inspecting the 'Faster_R-CNN' folder.

### A brief introduction to the relevant documents

Faster_R-CNN.py: Scripts for dataset import and model training, validation and testing.

metrics.py: provides functions for multi-classification metrics.

model.py: provides functions for model algorithm

utils.py: provides functions for dataset import and graphing.

